machine:
  ruby:
    version: 2.2.3
  environment:
    KNAPSACK_PRO_REPO_PATH: ~/gems/knapsack_pro-ruby
    # In production you should use endpoint http://api.knapsackpro.com
    # Below endpoint is just for internal tests by KnapsackPro developers
    KNAPSACK_PRO_ENDPOINT: http://api-staging.knapsackpro.com
dependencies:
  pre:
    - mkdir ~/gems
    - cd ~/gems && git clone -b $CIRCLE_BRANCH --single-branch git@github.com:KnapsackPro/knapsack_pro-ruby.git
    - cd ~/gems/knapsack_pro-ruby && git branch
    - cd ~/gems/knapsack_pro-ruby && git log -n 1
test:
  override:
    - bundle exec rake knapsack_pro:rspec:
        parallel: true

    - bundle exec rake knapsack_pro:cucumber:
        parallel: true

    - bundle exec rake knapsack_pro:minitest[--verbose]:
        parallel: true
